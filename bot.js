// Generated by CoffeeScript 1.11.1
(function() {
  var Twitter, config, favoriteTweet, queryList, rand, retweet, twit;

  twit = require('twit');

  config = require('./config.js');

  rand = function(arr) {
    var index;
    index = Math.floor(Math.random() * arr.length);
    return arr[index];
  };

  Twitter = new twit(config);

  queryList = ['#logistics', '#shipping', '#freight', '#supplychain', '#exports', '#trade'];

  retweet = function() {
    var params;
    params = {
      q: rand(queryList),
      result_type: 'mixed',
      lang: 'en'
    };
    return Twitter.get('search/tweets', params, function(err, data) {
      var retweetId;
      if (err == null) {
        retweetId = data.statuses[0].id_str;
        return Twitter.post('statuses/retweet/:id', {
          id: retweetId
        }, function(err, response) {
          if ((response != null) && (err == null)) {
            console.log('Retweeted!');
          }
          if (err != null) {
            console.log('Something went wrong while Retweeting.');
            return console.log(err.message);
          }
        });
      } else {
        console.log('Something went wrong while Searching.');
        return console.log(err);
      }
    });
  };

  favoriteTweet = function() {
    var params;
    params = {
      q: rand(queryList),
      result_type: 'mixed',
      lang: 'en'
    };
    return Twitter.get('search/tweets', params, function(err, data) {
      var randomTweet, tweet;
      tweet = data.statuses;
      randomTweet = rand(tweet);
      if (typeof randomTweet !== 'undefined') {
        return Twitter.post('favorites/create', {
          id: randomTweet.id_str
        }, function(err, response) {
          if (err != null) {
            console.log('Something went wrong on Favorite Tweet.');
            return console.log(err.message);
          } else {
            return console.log('Favorite OK.');
          }
        });
      }
    });
  };

  favoriteTweet();

  setInterval(favoriteTweet, 5 * 60 * 1000);

  retweet();

  setInterval(retweet, 5 * 60 * 1000);

}).call(this);
